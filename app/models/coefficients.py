# -*- coding: utf-8 -*-
"""
Все таблицы коэффициентов для расчёта трудоёмкости
по методике СПбГУТ (Приложения 2-4)
"""

from typing import Dict

# =============================================================================
# Таблица 1.2 — Переводные коэффициенты kp_i средства разработки
# =============================================================================

TRANSLATION_COEFFICIENTS: Dict[str, float] = {
    "Assembler": 0.17,
    "Pascal": 0.42,
    "C#": 1.64,
    "C++": 1.00,
    "VBA": 3.48,
    "Clarion": 2.56,
    "1C": 3.86,
    "Скриптовые языки": 1.87,
    "HTML/CSS": 0.15,
    "XML/XSLT": 0.20,
    "Java": 1.69,
    "JavaScript": 1.87,
    "ASP": 1.74,
    "SQL": 1.96,
    "C": 0.51,
    "Object Pascal": 0.67,
    "Visual Basic": 3.48,
    "Clipper": 2.36,
    "FoxPro": 1.51,
    "PL/1": 0.91,
    "PL/SQL": 1.71,
    "PHP": 1.74,
    "J2EE": 1.06,
    "JCL": 1.10,
    "JSP": 1.02,
    "Perl": 1.74,
    "Rexx": 0.90,
    "VBScript": 1.56,
    "Uniface": 3.48,
    # Современные языки (отнесены к ближайшей группе)
    "Python": 1.87,      # Скриптовые языки
    "Go": 1.00,          # C++
    "Rust": 1.00,        # C++
    "Kotlin": 1.69,      # Java
    "Swift": 1.69,       # Java
    "TypeScript": 1.87,  # JavaScript
    "Ruby": 1.74,        # PHP/Perl
    "Dart": 1.69,        # Java
}

# =============================================================================
# Таблица 2.6 — Коэффициент сложности K_slozhn
# =============================================================================

COMPLEXITY_COEFFICIENTS: Dict[int, float] = {
    1: 0.82,   # Очень низкий
    2: 0.87,   # Низкий
    3: 1.00,   # Средний
    4: 1.10,   # Высокий
    5: 1.20,   # Очень высокий
    6: 1.41,   # Сверхвысокий
}

COMPLEXITY_LEVELS: Dict[int, str] = {
    1: "Очень низкий",
    2: "Низкий",
    3: "Средний",
    4: "Высокий",
    5: "Очень высокий",
    6: "Сверхвысокий",
}

# =============================================================================
# Таблица 2.7 — Коэффициент условий и средств разработки K_sr_razr
# =============================================================================

DEV_ENVIRONMENT_COEFFICIENTS: Dict[str, float] = {
    "Assembler": 1.52,
    "Pascal": 1.18,
    "C#": 0.92,
    "C++": 1.00,
    "VBA": 0.69,
    "Clarion": 0.47,
    "1C": 0.73,
    "Скриптовые языки": 0.79,
    "HTML/CSS": 0.64,
    "XML/XSLT": 0.69,
    "Java": 0.92,
    "JavaScript": 0.76,
    "ASP": 0.81,
    "SQL": 0.65,
    "C": 1.09,
    "Object Pascal": 1.10,
    "Visual Basic": 0.69,
    "Clipper": 0.58,
    "FoxPro": 0.66,
    "PL/1": 1.09,
    "PL/SQL": 0.58,
    "PHP": 0.81,
    "J2EE": 0.94,
    "JCL": 0.91,
    "JSP": 0.98,
    "Perl": 0.81,
    "Rexx": 1.12,
    "VBScript": 0.40,
    "Uniface": 0.69,
    # Современные языки
    "Python": 0.79,
    "Go": 1.00,
    "Rust": 1.00,
    "Kotlin": 0.92,
    "Swift": 0.92,
    "TypeScript": 0.76,
    "Ruby": 0.81,
    "Dart": 0.92,
}

# =============================================================================
# Таблица 2.8 — Опыт работы программистов со средством разработки K_opyt
# =============================================================================

DEVELOPER_EXPERIENCE: Dict[str, float] = {
    "Низкий (1-2 ПС)": 1.09,
    "Средний (3-4 ПС)": 1.00,
    "Высокий (5 ПС)": 0.91,
    "Очень высокий (более 5 ПС)": 0.84,
}

# =============================================================================
# Таблица 3.1 — Степень новизны ПС K_n
# =============================================================================

NOVELTY_COEFFICIENTS: Dict[str, float] = {
    "Принципиально новое ПС, новый тип ТС/ОС": 1.42,
    "Принципиально новое ПС, прежний ТС, новый ОС": 1.34,
    "Принципиально новое ПС, новый ТС, прежний ОС": 1.12,
    "Принципиально новое ПС, прежний тип ТС/ОС": 1.06,
    "Развитие ПС, новый тип ТС/ОС": 1.00,
    "Развитие ПС, прежний ТС, новый ОС": 0.94,
    "Развитие ПС, новый ТС, прежний ОС": 0.87,
    "Развитие ПС, прежний тип ТС/ОС": 0.80,
}

# =============================================================================
# Таблица 3.2 — Требования к надёжности ПС K_nad
# =============================================================================

RELIABILITY_COEFFICIENTS: Dict[str, float] = {
    "Низкий (незначительный ущерб)": 0.95,
    "Средний (восполнимый ущерб)": 1.00,
    "Высокий (потери рабочей информации)": 1.06,
    "Очень высокий (потери важной информации)": 1.16,
}

# =============================================================================
# Таблица 3.3 — Требования к производительности K_proizv
# =============================================================================

PERFORMANCE_COEFFICIENTS: Dict[str, float] = {
    "Не играет роли": 0.94,
    "Не установлены (приемлемое время отклика)": 1.00,
    "Умеренные требования": 1.06,
    "Повышенные требования": 1.12,
    "Исключительно высокие требования": 1.18,
}

# =============================================================================
# Таблица 3.4 — Информативность документации K_dokum
# =============================================================================

DOCUMENTATION_COEFFICIENTS: Dict[str, float] = {
    "Низкий (не учтены некоторые потребности ЖЦ)": 0.94,
    "Средний (соответствует потребностям ЖЦ)": 1.00,
    "Высокий (повышенный объём)": 1.07,
    "Очень высокий (избыточный объём)": 1.14,
}

# =============================================================================
# Таблица 3.5 — Опыт разработки ПС подобного типа K_or
# =============================================================================

DEVELOPMENT_EXPERIENCE: Dict[str, float] = {
    "Низкий (1-2 ПС)": 1.10,
    "Средний (3-4 ПС)": 1.00,
    "Высокий (5 ПС)": 0.88,
    "Очень высокий (более 5 ПС)": 0.81,
}

# =============================================================================
# Таблица 3.6 — Структура ПС K_str
# =============================================================================

STRUCTURE_COEFFICIENTS: Dict[str, float] = {
    "Монолитное ПС": 0.70,
    "ПС с набором библиотек": 1.00,
    "Многокомпонентное ПС (одна рабочая станция)": 1.10,
    "Многокомпонентное ПС (клиент-сервер)": 1.25,
    "Распределённое ПС": 1.60,
    "Распределённое ПС (неоднородное оборудование)": 1.85,
}

# =============================================================================
# Таблица 3.7 — Технологии взаимодействия компонентов K_t
# =============================================================================

INTERACTION_TECHNOLOGIES: Dict[str, float] = {
    "Оригинальный протокол (sockets)": 0.80,
    "Интернет-протоколы": 0.40,
    "Удалённый вызов процедур (RPC)": 0.45,
    "Брокер запросов (CORBA)": 0.30,
    "Объектно-ориентированные (COM/DCOM, ODBC, OLE DB, ADO, ActiveX)": 0.35,
}

# =============================================================================
# Таблица 3.8 — Влияние сроков работ K_sr_srok
# =============================================================================

DEADLINE_COEFFICIENTS: Dict[str, float] = {
    "≤75% от номинальной": 1.43,
    "76–85% от номинальной": 1.14,
    "86–100% от номинальной": 1.05,
    "≥100% от номинальной": 1.00,
}

# =============================================================================
# КОЭФФИЦИЕНТЫ УРОВНЯ ПОДПРОЦЕССА (Таблицы 4.1–4.11)
# =============================================================================

# Таблица 4.1 — Квалификация аналитиков K_kval_an
ANALYST_QUALIFICATION: Dict[str, float] = {
    "Средний": 1.00,
    "Высокий": 0.87,
    "Очень высокий": 0.74,
    "Исключительно высокий": 0.66,
}

# Таблица 4.2 — Опыт аналитиков K_opyt_an
ANALYST_EXPERIENCE: Dict[str, float] = {
    "Низкий (1-2 ПС)": 1.07,
    "Средний (3-4 ПС)": 1.00,
    "Высокий (5 ПС)": 0.87,
    "Очень высокий (более 5 ПС)": 0.81,
}

# Таблица 4.3 — Квалификация проектировщиков K_kval_pr
DESIGNER_QUALIFICATION: Dict[str, float] = {
    "Средний": 1.00,
    "Высокий": 0.92,
    "Очень высокий": 0.83,
    "Исключительно высокий": 0.77,
}

# Таблица 4.4 — Опыт проектировщиков K_opyt_pr
DESIGNER_EXPERIENCE: Dict[str, float] = {
    "Низкий (1-2 ПС)": 1.04,
    "Средний (3-4 ПС)": 1.00,
    "Высокий (5 ПС)": 0.92,
    "Очень высокий (более 5 ПС)": 0.88,
}

# Таблица 4.5 — Средства проектирования K_sr_pr
DESIGN_TOOLS: Dict[str, float] = {
    "Не использовались": 1.06,
    "Средства проектирования БД (BPWIN, ERWIN и т.д.)": 1.03,
    "Microsoft Visual Modeler, Cadre OMT": 0.93,
    "ОО CASE-средства (Rational Rose, db-UIM/X)": 0.84,
}

# Таблица 4.6 — Квалификация программистов K_kval_prog
PROGRAMMER_QUALIFICATION: Dict[str, float] = {
    "Средний": 1.00,
    "Высокий": 0.95,
    "Очень высокий": 0.89,
    "Исключительно высокий": 0.86,
}

# Таблица 4.7 — Среда разработки K_sr (для программирования)
IDE_COEFFICIENTS: Dict[str, float] = {
    "Простые текстовые редакторы (Notepad, vi)": 1.06,
    "Мощные редакторы (UltraEdit, MultiEdit)": 1.04,
    "Интегрированные среды (Visual Studio)": 1.00,
    "Мощные IDE с генерацией кода (Delphi, JBuilder, C++ Builder)": 0.95,
    "Среды на основе СУБД (Oracle Developer, Informix, MS SQL Server)": 0.92,
    "Среды с VBA (Access, Excel, 1C, Lotus Notes)": 0.90,
}

# Таблица 4.8 — Квалификация тестировщиков K_kval_test
TESTER_QUALIFICATION: Dict[str, float] = {
    "Средний": 1.00,
    "Высокий": 0.89,
    "Очень высокий": 0.76,
    "Исключительно высокий": 0.69,
}

# Таблица 4.9 — Средства тестирования K_sr_ts
TESTING_TOOLS: Dict[str, float] = {
    "Не использовались": 1.00,
    "Использовались": 0.76,
}

# Таблица 4.10 — Размер БД K_BD
DB_SIZE: Dict[str, float] = {
    "Низкий (D/P < 10)": 0.95,
    "Средний (10 ≤ D/P < 100)": 1.00,
    "Высокий (100 ≤ D/P < 1000)": 1.08,
    "Очень высокий (D/P ≥ 1000)": 1.15,
}

# Таблица 4.11 — Квалификация персонала ввода в действие K_kval_vn
DEPLOYMENT_QUALIFICATION: Dict[str, float] = {
    "Средний": 1.00,
    "Высокий": 0.94,
    "Очень высокий": 0.88,
    "Исключительно высокий": 0.87,
}

# =============================================================================
# УРОВНИ СЛОЖНОСТИ (Таблицы 2.1–2.5)
# =============================================================================

# Таблица 2.1 — Сложность управляющих операций
COMPLEXITY_CONTROL_OPERATIONS: Dict[int, str] = {
    1: "Очень низкий: простые циклы, минимум вложенности, простые предикаты",
    2: "Низкий: простые вложенные циклы, несложные предикаты, простые таблицы решений",
    3: "Средний: умеренная вложенность, составные предикаты, несложная рекурсия",
    4: "Высокий: значительная вложенность, сложные предикаты, умеренная рекурсия",
    5: "Очень высокий: глубокая вложенность, очень сложные предикаты, сложная рекурсия",
    6: "Сверхвысокий: сложнейшие алгоритмы управления, многоуровневая рекурсия",
}

# Таблица 2.2 — Сложность вычислительных операций
COMPLEXITY_COMPUTATIONAL_OPERATIONS: Dict[int, str] = {
    1: "Очень низкий: простые выражения, линейные операции",
    2: "Низкий: несложные выражения, простые массивы, базовые вычисления",
    3: "Средний: умеренно сложные выражения, работа с массивами, стандартные алгоритмы",
    4: "Высокий: сложные вычисления, численный анализ, оптимизация",
    5: "Очень высокий: сложный численный анализ, матричные операции",
    6: "Сверхвысокий: высшая математика, сложнейшие численные методы",
}

# Таблица 2.3 — Сложность операций, зависящих от аппаратуры
COMPLEXITY_HARDWARE_OPERATIONS: Dict[int, str] = {
    1: "Очень низкий: простой ввод-вывод, стандартные устройства",
    2: "Низкий: несложная работа с файлами, простые форматы",
    3: "Средний: работа с различными форматами, умеренная обработка данных",
    4: "Высокий: обработка прерываний, управление каналами, драйверы",
    5: "Очень высокий: сложное управление устройствами, многопоточность I/O",
    6: "Сверхвысокий: низкоуровневое управление аппаратурой, реальное время",
}

# Таблица 2.4 — Сложность операций управления данными
COMPLEXITY_DATA_OPERATIONS: Dict[int, str] = {
    1: "Очень низкий: простые массивы, последовательные файлы",
    2: "Низкий: индексные файлы, простые запросы SQL",
    3: "Средний: сложные запросы SQL, хранимые процедуры, триггеры",
    4: "Высокий: распределённые БД, сложная логика триггеров, репликация",
    5: "Очень высокий: комплексная распределённая обработка, OLAP",
    6: "Сверхвысокий: сверхсложные распределённые системы данных",
}

# Таблица 2.5 — Сложность операций управления пользовательского интерфейса
COMPLEXITY_UI_OPERATIONS: Dict[int, str] = {
    1: "Очень низкий: простые формы, минимум элементов управления",
    2: "Низкий: несложные диалоги, стандартные элементы управления",
    3: "Средний: сложные формы, нестандартные элементы, простая графика",
    4: "Высокий: сложная графика, нестандартные визуальные эффекты",
    5: "Очень высокий: мультимедиа, анимация, 3D-графика",
    6: "Сверхвысокий: сложнейшие графические системы, VR/AR",
}

# Объединённый словарь для получения описаний сложности по типу операции
COMPLEXITY_LEVELS_BY_OPERATION = {
    "CONTROL": COMPLEXITY_CONTROL_OPERATIONS,
    "COMPUTATIONAL": COMPLEXITY_COMPUTATIONAL_OPERATIONS,
    "HARDWARE_DEPENDENT": COMPLEXITY_HARDWARE_OPERATIONS,
    "DATA_MANAGEMENT": COMPLEXITY_DATA_OPERATIONS,
    "USER_INTERFACE": COMPLEXITY_UI_OPERATIONS,
}


def get_complexity_description(operation_type: str, level: int) -> str:
    """Получить описание уровня сложности для типа операции"""
    op_type = operation_type.upper().replace(" ", "_")
    if op_type in COMPLEXITY_LEVELS_BY_OPERATION:
        descriptions = COMPLEXITY_LEVELS_BY_OPERATION[op_type]
        return descriptions.get(level, f"Уровень {level}")
    return f"Уровень {level}"


def get_all_languages() -> list[str]:
    """Получить список всех языков программирования"""
    return sorted(TRANSLATION_COEFFICIENTS.keys())
